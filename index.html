<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MİT | GÜVENLİ PERSONEL UYGULAMASI</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <style>
    :root {
      --mit-primary: #003087;
      --mit-accent: #0055b3;
      --border: #b0c4de;
      --danger: #8b0000;
      --success: #006400;
      --bg-main: #f4f6f9;
      --panel: #ffffff;
      --shadow: 0 4px 20px rgba(0,0,0,0.1);
    }
    body { background: var(--bg-main); color: #003087; font-family: 'Roboto', sans-serif; margin: 0; min-height: 100vh; transition: all 0.4s ease; }
    body.dark { --bg-main: #0d1117; --panel: #161b22; --border: #30363d; color: #c9d1d9; }
    body.dark .profil-kart, body.dark .content, body.dark .login-container { background: #161b22; border-color: #30363d; }
    body.dark input, body.dark textarea, body.dark select { background: #0d1117; color: #c9d1d9; border-color: #30363d; }
    body.dark .sidebar { background: #010409; }
    body.dark .header { background: #010409; }
    .app-container { display: flex; min-height: 100vh; }
    .sidebar { width: 260px; background: var(--mit-primary); color: white; padding: 1.5rem 1rem; position: fixed; height: 100%; overflow-y: auto; display: none; z-index: 100; transition: all 0.3s; }
    body.panel-active .sidebar { display: block; }
    .sidebar button { width: 100%; padding: 1rem 1.2rem; margin: 0.5rem 0; color: white; background: rgba(255,255,255,0.08); border: none; border-radius: 6px; text-align: left; font-size: 1rem; cursor: pointer; transition: all 0.2s; }
    .sidebar button:hover { background: rgba(255,255,255,0.18); }
    .sidebar button.active { background: rgba(255,255,255,0.3); font-weight: 600; }
    .main-area { flex: 1; margin-left: 0; transition: margin-left 0.4s; padding-top: 80px; }
    body.panel-active .main-area { margin-left: 260px; }
    .header { background: var(--mit-primary); color: white; padding: 1.2rem 2.5rem; display: flex; justify-content: space-between; align-items: center; position: fixed; top: 0; left: 0; right: 0; z-index: 99; }
    .theme-toggle { width: 48px; height: 48px; background: rgba(255,255,255,0.2); border: none; border-radius: 50%; color: white; font-size: 1.3rem; cursor: pointer; }
    .content { padding: 2.5rem; display: none; background: var(--panel); border-radius: 8px; margin: 1.5rem; box-shadow: var(--shadow); }
    .content.active { display: block; }
    .login-container { max-width: 540px; margin: 15vh auto; background: white; padding: 4rem 3.5rem; border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); text-align: center; }
    input, textarea, select { width: 100%; padding: 0.9rem 1.2rem; margin: 0.8rem 0; border: 1px solid var(--border); border-radius: 4px; font-size: 1rem; }
    #access-password { font-family: monospace; letter-spacing: 4px; text-align: center; font-size: 1.6rem; padding: 1.2rem; border: 2px solid #003087; border-radius: 8px; }
    button.primary { background: var(--mit-primary); color: white; border: none; padding: 1.2rem 2rem; border-radius: 4px; cursor: pointer; font-weight: 500; transition: background 0.3s; font-size: 1.2rem; width: 100%; }
    button.primary:hover { background: var(--mit-accent); }
    .profil-kart { display: grid; grid-template-columns: 1fr 1fr; gap: 2.5rem; background: linear-gradient(135deg, #f8f9fa, #e9f0ff); border: 2px solid var(--mit-primary); border-radius: 12px; padding: 2.5rem; margin-bottom: 3rem; box-shadow: 0 8px 30px rgba(0,48,135,0.15); }
    .arsiv-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.8rem; margin: 2.5rem 0; }
    .kutu { background: linear-gradient(135deg, #0d47a1, #1976d2); color: white; border: 2px solid #1565c0; border-radius: 12px; padding: 2rem 1.5rem; cursor: pointer; transition: all 0.35s ease; box-shadow: 0 6px 18px rgba(21,101,192,0.3); }
    .kutu:hover { transform: translateY(-8px); box-shadow: 0 14px 32px rgba(21,101,192,0.5); background: linear-gradient(135deg, #1565c0, #1e88e5); }
    .alt-kutu { background: linear-gradient(135deg, #1976d2, #2196f3); color: white; border: 2px solid #42a5f5; margin: 1rem 0; padding: 1.5rem; border-radius: 10px; }
    .alt-kutu:hover { background: linear-gradient(135deg, #2196f3, #42a5f5); }
    .admin-section { margin: 2.5rem 0; padding-top: 1.5rem; border-top: 1px solid var(--border); }
    .success-msg { color: var(--success); text-align: center; margin-top: 1rem; display: none; font-weight: bold; }
    .dosya-detay { margin-top: 1.5rem; padding: 1.5rem; background: rgba(255,255,255,0.15); border-radius: 8px; border-left: 5px solid var(--mit-accent); }
    body.dark .dosya-detay { background: rgba(0,0,0,0.3); }
  </style>
</head>
<body>
<div class="app-container">
  <nav class="sidebar" id="sidebar">
    <h3>PERSONEL MENÜSÜ</h3>
    <button onclick="showSection('dashboard')" class="active">Ana Panel</button>
    <button onclick="showSection('mit-arsivi')">MİT'in Arşivi</button>
    <button onclick="showSection('rapor')">Rapor Yaz</button>
    <button onclick="showSection('duyurular')">Personel Bilgilendirme</button>
    <button id="admin-yonetim-btn" onclick="showSection('yonetici-paneli')" style="display:none;">Yönetici Paneli</button>
    <button onclick="cikisYap()">Çıkış Yap</button>
  </nav>

  <div class="main-area">
    <header class="header">
      <div>MİLLİ İSTİHBARAT TEŞKİLATI</div>
      <div style="display:flex; align-items:center; gap:1.5rem;">
        <span>TERMINAL • <span id="current-time">00:00</span> • SEVİYE 4</span>
        <button class="theme-toggle" id="theme-toggle-btn"><i class="fas fa-moon"></i></button>
      </div>
    </header>

    <div class="login-container" id="giris">
      <h1>PERSONEL GİRİŞİ</h1>
      <p style="color:#555; margin:2rem 0;">GİZLİLİK DERECESİ: ÇOK GİZLİ</p>
      <input type="text" id="personel-kodadi" placeholder="KOD ADI (örn: KORKUT)" autocomplete="off" style="text-transform:uppercase;">
      <input type="password" id="access-password" placeholder="PERSONEL KODU" autocomplete="off">
      <button class="primary" id="giris-buton">GİRİŞ YAP</button>
      <p id="wrong-pass" style="color:var(--danger); display:none; margin-top:1.5rem; font-weight:bold;"></p>
    </div>

    <div id="panel" style="display:none;">
      <div id="dashboard" class="content active">
        <h2>ANA PANEL</h2>
        <div class="profil-kart">
          <div>
            <h3 id="giris-yapan-isim">---</h3>
            <p id="giris-yapan-rutbe">Rütbe: ---</p>
          </div>
          <div>
            <p><strong>Aktif Görev:</strong></p>
            <p style="color:var(--success); font-weight:bold; font-size:1.4rem;">Bölge Takibi ve Analizi (Aktif)</p>
            <p style="font-style:italic; color:#555; margin-top:1.5rem;">"Görülmeyeni görür, duyulmayanı duyarız"</p>
          </div>
        </div>
      </div>

      <div id="mit-arsivi" class="content">
        <h2>MİT'İN ARŞİVİ</h2>
        <p style="color:#555; margin-bottom:1.5rem;">Kişi ve organizasyonlara ait istihbarat kayıtları, suç/hata dosyaları</p>
        <div class="arsiv-grid" id="arsiv-grid"></div>
        <div id="arsiv-detay" style="display:none;"></div>
      </div>

      <div id="rapor" class="content">
        <h2>RAPOR YAZ</h2>
        <input type="text" value="KORKUT" readonly>
        <input type="text" value="TR-MİT-KOM-009" readonly>
        <select id="unit"><option>BİRİM SEÇ</option><option>Komuta</option><option>Karşı İstihbarat</option><option>Siber</option></select>
        <select id="status"><option>DURUM SEÇ</option><option>Aktif</option><option>Tamamlandı</option><option>Acil</option></select>
        <div style="display:flex; flex-wrap:wrap; gap:0.8rem; margin:1.5rem 0;">
          <button class="primary" onclick="sablonDoldur('kisi')">Kişi Takip</button>
          <button class="primary" onclick="sablonDoldur('operasyon')">Operasyon</button>
          <button class="primary" onclick="sablonDoldur('acil')">Acil Durum</button>
        </div>
        <textarea id="report-text" rows="8" placeholder="Rapor içeriği..."></textarea>
        <button class="primary" onclick="gonderRapor()">RAPORU GÖNDER</button>
        <p id="raporSuccess" class="success-msg">✓ Rapor merkeze iletildi</p>
      </div>

      <div id="duyurular" class="content">
        <h2>Personel Bilgilendirme</h2>
        <p>Duyurular Discord sunucusunda paylaşılmaktadır.</p>
        <a href="https://discord.gg/a6XbjtkR" target="_blank" class="primary" style="display:block; text-align:center; margin:2rem auto; max-width:300px;">
          <i class="fab fa-discord"></i> DISCORD'A GİT
        </a>
      </div>

      <div id="yonetici-paneli" class="content">
        <h2>YÖNETİCİ PANELİ</h2>
        <div class="admin-section">
          <h3>Yeni Kategori Ekle</h3>
          <input id="kategori-baslik" placeholder="Kategori Adı (örn: Emniyet Personeli)">
          <textarea id="kategori-aciklama" placeholder="Kısa açıklama"></textarea>
          <button class="primary" onclick="kategoriEkle()">KATEGORİ EKLE</button>
          <p id="kategoriSuccess" class="success-msg">✓ Kategori eklendi</p>
        </div>
        <div class="admin-section">
          <h3>Kategori Kaldır</h3>
          <select id="kaldir-kategori"></select>
          <button class="primary" style="background:var(--danger); width:100%; margin-top:0.8rem;" onclick="kategoriKaldir()">KATEGORİYİ KALDIR</button>
          <p id="kaldirSuccess" class="success-msg">✓ Kategori kaldırıldı</p>
        </div>
        <div class="admin-section">
          <h3>Alt Konu / Rapor Ekle</h3>
          <select id="alt-ekle-kategori"></select>
          <input id="alt-baslik" placeholder="Alt konu / Rapor başlığı">
          <textarea id="alt-detay" placeholder="Detay (suç, hata, istihbarat kaydı vs.)"></textarea>
          <input id="alt-tarih" placeholder="Tarih (örn: 15 Ocak 2026)" value="15 Ocak 2026">
          <button class="primary" onclick="altKonuEkle()">ALT KONU / RAPOR EKLE</button>
          <p id="altSuccess" class="success-msg">✓ Eklendi</p>
        </div>
        <div class="admin-section">
          <h3>Alt Konu / Rapor Kaldır</h3>
          <select id="alt-kaldir-kategori" onchange="updateAltKaldirSelect()"></select>
          <select id="alt-kaldir-item"></select>
          <button class="primary" style="background:var(--danger); width:100%; margin-top:0.8rem;" onclick="altKonuKaldir()">SEÇİLİ RAPORU KALDIR</button>
          <p id="altKaldirSuccess" class="success-msg" style="display:none;">✓ Rapor kaldırıldı</p>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// ──────────────────────────────────────────────
//          PERSONEL VERİTABANI
// ──────────────────────────────────────────────
const PERSONELLER = [
  { kodadi: "KORKUT",   sifre: "MIT2026CCCC1965", rutbe: "Komuta Harekat Merkezi",      seviye: 5, isAdmin: true  },
  { kodadi: "BEYAZIT",  sifre: "MIT2026BBBB1453", rutbe: "Karşı İstihbarat Şefi",        seviye: 4, isAdmin: false },
  { kodadi: "ANKA",     sifre: "MIT2026DDDD0033", rutbe: "Operasyon Uzmanı",            seviye: 3, isAdmin: false },
  { kodadi: "NEO",      sifre: "MIT2026EEEE0044", rutbe: "Siber Güvenlik Analisti",     seviye: 3, isAdmin: false },
  { kodadi: "SARI",     sifre: "MIT2026CCCC0055", rutbe: "Analiz ve Değerlendirme",     seviye: 3, isAdmin: false },
  { kodadi: "YILKIRAN", sifre: "MIT2026DDDD0066", rutbe: "Saha İstihbarat Görevlisi",    seviye: 4, isAdmin: false },
  { kodadi: "ZÜMRÜT",   sifre: "MIT2026AAAA0077", rutbe: "Teknolojik İzleme Uzmanı",    seviye: 3, isAdmin: false }
];

let currentUser = null;
let isAdmin = false;

const STORAGE_KEY = 'mit_arsiv_kategoriler';

let arsivKategoriler = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [
  { id: '1', baslik: 'Emniyet Personeli', aciklama: 'Emniyet teşkilatındaki şüpheli hareketler ve bağlantılar', icerik: [] },
  { id: '2', baslik: 'Yargı Mensupları', aciklama: 'Hâkim, savcı ve adli personel dosyaları', icerik: [] }
];

function renderArsiv() {
  const grid = document.getElementById('arsiv-grid');
  if (!grid) return;
  grid.innerHTML = '';
  arsivKategoriler.forEach(kat => {
    const div = document.createElement('div');
    div.className = 'kutu';
    div.innerHTML = `
      <h3>${kat.baslik}</h3>
      <p>${kat.aciklama}</p>
      <p style="margin-top:1rem; font-weight:bold;">${kat.icerik.length} kayıt</p>
    `;
    div.onclick = () => arsivKategoriAc(kat);
    grid.appendChild(div);
  });
  updateYonetimDropdowns();
}

function arsivKategoriAc(kat) {
  document.getElementById('arsiv-grid').style.display = 'none';
  const detay = document.getElementById('arsiv-detay');
  detay.style.display = 'block';
  let html = `
    <button class="primary" onclick="arsivGeriDon()">Geri Dön</button>
    <h2>${kat.baslik}</h2>
    <p>${kat.aciklama}</p>
    <h3>Kayıtlar:</h3>
  `;
  if (kat.icerik.length === 0) {
    html += '<p>Henüz kayıt yok.</p>';
  } else {
    kat.icerik.forEach(item => {
      html += `<div class="alt-kutu"><strong>${item.baslik}</strong> <small>(${item.tarih})</small><br>${item.detay}</div>`;
    });
  }
  detay.innerHTML = html;
}

function arsivGeriDon() {
  document.getElementById('arsiv-grid').style.display = 'grid';
  document.getElementById('arsiv-detay').style.display = 'none';
}

function showSection(id) {
  document.querySelectorAll('.content').forEach(el => el.classList.remove('active'));
  const target = document.getElementById(id);
  if (target) target.classList.add('active');
  document.querySelectorAll('.sidebar button').forEach(btn => btn.classList.remove('active'));
  const activeBtn = document.querySelector(`button[onclick="showSection('${id}')"]`);
  if (activeBtn) activeBtn.classList.add('active');
  if (id === 'mit-arsivi') renderArsiv();
}

function girisYap() {
  const kodadi = document.getElementById('personel-kodadi').value.trim().toUpperCase();
  const sifre = document.getElementById('access-password').value.trim();
  const errorP = document.getElementById('wrong-pass');

  errorP.style.display = 'none';

  if (!kodadi || !sifre) {
    errorP.textContent = '× KOD ADI ve PERSONEL KODU GİRMEDİNİZ ×';
    errorP.style.display = 'block';
    return;
  }

  const user = PERSONELLER.find(p => p.kodadi.toUpperCase() === kodadi && p.sifre === sifre);

  if (!user) {
    errorP.textContent = '× GEÇERSİZ KOD ADI / PERSONEL KODU – MERKEZE BİLDİRİLDİ ×';
    errorP.style.display = 'block';
    document.getElementById('access-password').value = '';
    document.getElementById('personel-kodadi').select();
    return;
  }

  currentUser = user;
  isAdmin = user.isAdmin === true;

  document.getElementById('giris-yapan-isim').textContent = user.kodadi;
  document.getElementById('giris-yapan-rutbe').textContent = `Rütbe: ${user.rutbe}`;

  document.getElementById('admin-yonetim-btn').style.display = isAdmin ? 'block' : 'none';

  document.getElementById('giris').style.display = 'none';
  document.getElementById('panel').style.display = 'block';
  document.body.classList.add('panel-active');

  showSection('dashboard');
  renderArsiv();
}

function cikisYap() {
  if (!confirm('Çıkış yapmak istiyor musunuz?')) return;
  currentUser = null;
  isAdmin = false;
  document.getElementById('admin-yonetim-btn').style.display = 'none';
  document.getElementById('panel').style.display = 'none';
  document.getElementById('giris').style.display = 'block';
  document.body.classList.remove('panel-active');
  document.getElementById('personel-kodadi').value = '';
  document.getElementById('access-password').value = '';
}

function sablonDoldur(tip) {
  const area = document.getElementById('report-text');
  const date = new Date().toLocaleDateString('tr-TR');
  let text = `Tarih: ${date}\n`;
  if (tip === 'kisi') text += 'KİŞİ TAKİP RAPORU\nHedef: \nKonum: \nGözlem: ';
  else if (tip === 'operasyon') text += 'OPERASYON RAPORU\nKodu: \nSonuç: \nToplanan veri: ';
  else if (tip === 'acil') text += 'ACİL DURUM RAPORU\nTehdit seviyesi: \nAçıklama: ';
  area.value = text;
}

function gonderRapor() {
  if (!document.getElementById('report-text').value.trim()) return alert('Rapor içeriği boş olamaz!');
  document.getElementById('raporSuccess').style.display = 'block';
  setTimeout(() => {
    document.getElementById('raporSuccess').style.display = 'none';
    document.getElementById('report-text').value = '';
  }, 2500);
}

function kategoriEkle() {
  if (!isAdmin) return alert('Bu işlem için yetkiniz yok!');
  const baslik = document.getElementById('kategori-baslik')?.value.trim();
  const aciklama = document.getElementById('kategori-aciklama')?.value.trim();
  if (!baslik) return alert('Kategori adı zorunlu!');
  const yeni = { id: Date.now().toString(), baslik, aciklama, icerik: [] };
  arsivKategoriler.push(yeni);
  localStorage.setItem(STORAGE_KEY, JSON.stringify(arsivKategoriler));
  document.getElementById('kategoriSuccess').style.display = 'block';
  setTimeout(() => {
    document.getElementById('kategoriSuccess').style.display = 'none';
    document.getElementById('kategori-baslik').value = '';
    document.getElementById('kategori-aciklama').value = '';
    renderArsiv();
    updateYonetimDropdowns();
  }, 1800);
}

function kategoriKaldir() {
  if (!isAdmin) return alert('Bu işlem için yetkiniz yok!');
  const select = document.getElementById('kaldir-kategori');
  const id = select?.value?.trim();
  if (!id) return alert('Lütfen kaldırılacak kategoriyi seçin!');
  if (!confirm('Bu kategori ve içindeki tüm kayıtlar kalıcı olarak silinecek. Emin misiniz?')) return;
  arsivKategoriler = arsivKategoriler.filter(k => k.id !== id);
  localStorage.setItem(STORAGE_KEY, JSON.stringify(arsivKategoriler));
  document.getElementById('kaldirSuccess').style.display = 'block';
  setTimeout(() => {
    document.getElementById('kaldirSuccess').style.display = 'none';
    renderArsiv();
    updateYonetimDropdowns();
  }, 2000);
}

function altKonuEkle() {
  if (!isAdmin) return alert('Bu işlem için yetkiniz yok!');
  const katId = document.getElementById('alt-ekle-kategori')?.value?.trim();
  const baslik = document.getElementById('alt-baslik')?.value.trim();
  const detay = document.getElementById('alt-detay')?.value.trim();
  const tarih = document.getElementById('alt-tarih')?.value.trim() || new Date().toLocaleDateString('tr-TR');
  if (!katId || !baslik || !detay) return alert('Kategori, başlık ve detay zorunlu!');
  const kategori = arsivKategoriler.find(k => k.id === katId);
  if (!kategori) return alert('Kategori bulunamadı');
  kategori.icerik.push({ baslik, detay, tarih });
  localStorage.setItem(STORAGE_KEY, JSON.stringify(arsivKategoriler));
  document.getElementById('altSuccess').style.display = 'block';
  setTimeout(() => {
    document.getElementById('altSuccess').style.display = 'none';
    document.getElementById('alt-baslik').value = '';
    document.getElementById('alt-detay').value = '';
    renderArsiv();
    updateYonetimDropdowns();
  }, 1800);
}

function updateYonetimDropdowns() {
  const html = '<option value="">Seçiniz</option>' + arsivKategoriler.map(k => `<option value="${k.id}">${k.baslik}</option>`).join('');
  ['kaldir-kategori', 'alt-ekle-kategori', 'alt-kaldir-kategori'].forEach(id => {
    const el = document.getElementById(id);
    if (el) el.innerHTML = html;
  });
  updateAltKaldirSelect();
}

function updateAltKaldirSelect() {
  const katId = document.getElementById('alt-kaldir-kategori')?.value?.trim();
  const sel = document.getElementById('alt-kaldir-item');
  if (!sel) return;
  sel.innerHTML = '<option value="">Rapor seçin</option>';
  if (!katId) return;
  const kategori = arsivKategoriler.find(k => k.id === katId);
  if (!kategori || kategori.icerik.length === 0) {
    sel.innerHTML += '<option value="" disabled>Rapor yok</option>';
    return;
  }
  kategori.icerik.forEach((item, idx) => {
    const opt = document.createElement('option');
    opt.value = idx;
    opt.textContent = `${item.baslik || 'İsimsiz'} (${item.tarih || 'Tarih yok'})`;
    sel.appendChild(opt);
  });
}

function altKonuKaldir() {
  if (!isAdmin) return alert('Bu işlem için yetkiniz yok!');
  const katId = document.getElementById('alt-kaldir-kategori')?.value?.trim();
  const idxStr = document.getElementById('alt-kaldir-item')?.value?.trim();
  if (!katId || !idxStr) return alert('Lütfen kategori ve rapor seçin!');
  const idx = parseInt(idxStr);
  const kategori = arsivKategoriler.find(k => k.id === katId);
  if (!kategori || isNaN(idx) || idx < 0 || idx >= kategori.icerik.length) return alert('Geçersiz seçim!');
  if (!confirm(`"${kategori.icerik[idx].baslik || 'Bu kayıt'}" kalıcı olarak silinecek. Emin misiniz?`)) return;
  kategori.icerik.splice(idx, 1);
  localStorage.setItem(STORAGE_KEY, JSON.stringify(arsivKategoriler));
  document.getElementById('altKaldirSuccess').style.display = 'block';
  setTimeout(() => {
    document.getElementById('altKaldirSuccess').style.display = 'none';
    updateAltKaldirSelect();
    renderArsiv();
  }, 2000);
}

// Saat
setInterval(() => {
  document.getElementById('current-time').textContent = new Date().toLocaleTimeString('tr-TR', {hour12:false});
}, 1000);

// Tema
document.getElementById('theme-toggle-btn').onclick = () => {
  document.body.classList.toggle('dark');
  const icon = document.querySelector('#theme-toggle-btn i');
  icon.classList.toggle('fa-moon');
  icon.classList.toggle('fa-sun');
};

// Sayfa yüklendiğinde
document.addEventListener('DOMContentLoaded', () => {
  document.getElementById('giris-buton').addEventListener('click', girisYap);
  document.getElementById('personel-kodadi').addEventListener('keypress', e => {
    if (e.key === 'Enter') document.getElementById('access-password').focus();
  });
  document.getElementById('access-password').addEventListener('keypress', e => {
    if (e.key === 'Enter') girisYap();
  });
  document.getElementById('personel-kodadi').focus();
  updateYonetimDropdowns();
});
</script>
</body>
</html>
